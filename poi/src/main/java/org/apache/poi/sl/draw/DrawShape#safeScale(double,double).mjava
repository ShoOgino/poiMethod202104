    private static double safeScale(double dim1, double dim2) {
        return (dim1 == 0. || dim2 == 0.) ? 1 : dim1/dim2;
    }


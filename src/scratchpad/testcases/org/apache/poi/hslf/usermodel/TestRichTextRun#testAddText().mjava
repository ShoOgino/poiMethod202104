	public void testAddText() throws Exception {
		SlideShow ppt = new SlideShow(_slTests.openResourceAsStream("bullets.ppt"));
		assertTrue("No Exceptions while reading file", true);

		RichTextRun rt;
		TextRun[] txt;
		Slide[] slides = ppt.getSlides();

		assertEquals(2, slides.length);
		txt = slides[0].getTextRuns();
		assertEquals(2, txt.length);

		assertEquals("Title text", txt[0].getRawText());
		assertEquals(1, txt[0].getRichTextRuns().length);
		rt = txt[0].getRichTextRuns()[0];
		assertFalse(rt.isBullet());

		// Add some new text
		txt[0].appendText("Foo! I'm new!");
		assertEquals(2, txt[0].getRichTextRuns().length);

		rt = txt[0].getRichTextRuns()[0];
		assertFalse(rt.isBold());
		assertEquals("Title text", rt.getText());
		rt = txt[0].getRichTextRuns()[1];
		assertFalse(rt.isBold());
		assertEquals("Foo! I'm new!", rt.getText());
		rt.setBold(true);

		// And some more
		txt[0].appendText("Me too!");
		assertEquals(3, txt[0].getRichTextRuns().length);
		rt = txt[0].getRichTextRuns()[0];
		assertFalse(rt.isBold());
		assertEquals("Title text", rt.getText());
		rt = txt[0].getRichTextRuns()[1];
		assertTrue(rt.isBold());
		assertEquals("Foo! I'm new!", rt.getText());
		rt = txt[0].getRichTextRuns()[2];
		assertFalse(rt.isBold());
		assertEquals("Me too!", rt.getText());

		// Save and re-open
		ByteArrayOutputStream out = new ByteArrayOutputStream();
		ppt.write(out);
		out.close();

		ppt = new SlideShow(new ByteArrayInputStream(out.toByteArray()));
		slides = ppt.getSlides();

		assertEquals(2, slides.length);

		txt = slides[0].getTextRuns();
		assertEquals(2, txt.length);
		assertEquals(3, txt[0].getRichTextRuns().length);
		rt = txt[0].getRichTextRuns()[0];
		assertFalse(rt.isBold());
		assertEquals("Title text", rt.getText());
		rt = txt[0].getRichTextRuns()[1];
		assertTrue(rt.isBold());
		assertEquals("Foo! I'm new!", rt.getText());
		rt = txt[0].getRichTextRuns()[2];
		assertFalse(rt.isBold());
		assertEquals("Me too!", rt.getText());

//		FileOutputStream fout = new FileOutputStream("/tmp/foo.ppt");
//		ppt.write(fout);
	}


    // the display name annotation is ignored by ants junitlauncher listeners :(
    // ... even when using a custom display name generator
    @ParameterizedTest(name = "#{index} {0}" )
    @MethodSource("files")
    public void testAllFiles(String file, FileHandler handler) throws Exception {
        assertNotNull(handler, "Did not find a handler for file " + file);

        // this also removes the password for non encrypted files
        String pass = TestAllFiles.FILE_PASSWORD.get(file);
        Biff8EncryptionKey.setCurrentUserPassword(pass);


        System.out.println("Reading " + file + " with " + handler.getClass().getSimpleName());
        assertNotNull( handler, "Unknown file extension for file: " + file + ": " + getExtension(file) );
        File inputFile = new File(ROOT_DIR, file);

        // special cases where docx-handling breaks, but OPCPackage handling works
        boolean ignoredOPC = (file.endsWith(".docx") || file.endsWith(".xlsx") ||
                    file.endsWith(".xlsb") || file.endsWith(".pptx")) &&
                handler instanceof OPCFileHandler;
        boolean ignoreHPSF = (handler instanceof HPSFFileHandler);

        try {
            try (InputStream stream = new BufferedInputStream(new FileInputStream(inputFile), 64 * 1024)) {
                handler.handleFile(stream, file);
                assertFalse( OLD_FILES_HWPF.contains(file) && !ignoreHPSF, "Expected to fail for file " + file + " and handler " + handler + ", but did not fail!" );
            }

            handler.handleExtracting(inputFile);

            assertFalse( EXPECTED_FAILURES.contains(file) && !ignoredOPC && !ignoreHPSF, "Expected to fail for file " + file + " and handler " + handler + ", but did not fail!" );
        } catch (OldFileFormatException e) {
            // for old word files we should still support extracting text
            if(OLD_FILES_HWPF.contains(file)) {
                handler.handleExtracting(inputFile);
            } else {
                // check if we expect failure for this file
                if(!EXPECTED_FAILURES.contains(file) && !AbstractFileHandler.EXPECTED_EXTRACTOR_FAILURES.contains(file)) {
                    System.out.println("Failed: " + file);
                    throw new Exception("While handling " + file, e);
                }
            }
        } catch (TestAbortedException e) {
            // file handler ignored this file
        } catch (Exception e) {
            // check if we expect failure for this file
            if(!EXPECTED_FAILURES.contains(file) && !AbstractFileHandler.EXPECTED_EXTRACTOR_FAILURES.contains(file)) {
                System.out.println("Failed: " + file);
                throw new Exception("While handling " + file, e);
            }
        }

        try {
            // let some file handlers do additional stuff
            handler.handleAdditional(inputFile);
        } catch (TestAbortedException e) {
            // file handler ignored this file
        } catch (Exception e) {
            if(!EXPECTED_FAILURES.contains(file) && !AbstractFileHandler.EXPECTED_EXTRACTOR_FAILURES.contains(file)) {
                System.out.println("Failed: " + file);
                throw new Exception("While handling " + file, e);
            }
        }
    }


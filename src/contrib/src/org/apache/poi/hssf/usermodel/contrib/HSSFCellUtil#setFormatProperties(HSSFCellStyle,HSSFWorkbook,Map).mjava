    /**
     * Sets the format properties of the given style based on the given map.
     *
     * @param style cell style
     * @param workbook parent workbook
     * @param properties map of format properties (String -> Object)
     * @see #getFormatProperties(HSSFCellStyle)
     */
    private static void setFormatProperties(
            HSSFCellStyle style, HSSFWorkbook workbook, Map properties) {
        style.setAlignment( getShort( properties, ALIGNMENT ) );
        style.setBorderBottom( getShort( properties, BORDER_BOTTOM ) );
        style.setBorderLeft( getShort( properties, BORDER_LEFT ) );
        style.setBorderRight( getShort( properties, BORDER_RIGHT ) );
        style.setBorderTop( getShort( properties, BORDER_TOP ) );
        style.setBottomBorderColor( getShort( properties, BOTTOM_BORDER_COLOR ) );
        style.setDataFormat( getShort( properties, DATA_FORMAT ) );
        style.setFillBackgroundColor( getShort( properties, FILL_BACKGROUND_COLOR ) );
        style.setFillForegroundColor( getShort( properties, FILL_FOREGROUND_COLOR ) );
        style.setFillPattern( getShort( properties, FILL_PATTERN ) );
        style.setFont( workbook.getFontAt( getShort( properties, FONT ) ) );
        style.setHidden( getBoolean( properties, HIDDEN ) );
        style.setIndention( getShort( properties, INDENTION ) );
        style.setLeftBorderColor( getShort( properties, LEFT_BORDER_COLOR ) );
        style.setLocked( getBoolean( properties, LOCKED ) );
        style.setRightBorderColor( getShort( properties, RIGHT_BORDER_COLOR ) );
        style.setRotation( getShort( properties, ROTATION ) );
        style.setTopBorderColor( getShort( properties, TOP_BORDER_COLOR ) );
        style.setVerticalAlignment( getShort( properties, VERTICAL_ALIGNMENT ) );
        style.setWrapText( getBoolean( properties, WRAP_TEXT ) );
    }


	public void testAbortStops() throws Exception {
		AbortableCountingListener l = new AbortableCountingListener(1);
		
		HSSFRequest req = new HSSFRequest();
		req.addListenerForAllRecords(l);
		
		HSSFEventFactory f = new HSSFEventFactory();
		
		assertEquals(0, l.seen);
		assertEquals(null, l.lastseen);
		
		POIFSFileSystem fs = new POIFSFileSystem(new ByteArrayInputStream(
				getTestDataProvider().getTestDataFileContent("SimpleWithColours.xls")
		));
		short res = f.abortableProcessWorkbookEvents(req, fs);
		
		assertEquals(1234, res);
		assertEquals(1, l.seen);
		assertEquals(BOFRecord.sid, l.lastseen.getSid());
	}


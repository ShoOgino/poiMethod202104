	/**
	 * The PageSettingsBlock should not allow multiple copies of the same record.  This extra assertion
	 * was added while fixing bug 47199.  All existing POI test samples comply with this requirement.
	 */
	public void testDuplicatePSBRecord_bug47199() {

		// Hypothetical setup of PSB records which should cause POI to crash
		Record[] recs = {
				new HeaderRecord("&LSales Figures"),
				new HeaderRecord("&LInventory"),
		};
		RecordStream rs = new RecordStream(Arrays.asList(recs), 0);

		try {
			new PageSettingsBlock(rs);
			throw new AssertionFailedError("Identified bug 47199b - duplicate PSB records should not be allowed");
		} catch (RecordFormatException e) {
			if (e.getMessage().equals("Duplicate PageSettingsBlock record (sid=0x14)")) {
				// expected during successful test
			} else {
				throw new AssertionFailedError("Expected RecordFormatException due to duplicate PSB record");
			}
		}
	}


    public void testRemoveComment() throws Exception {
        CommentsTable sheetComments = new CommentsTable();
        CTComment a1 = sheetComments.newComment();
        a1.setRef("A1");
        CTComment a2 = sheetComments.newComment();
        a2.setRef("A2");
        CTComment a3 = sheetComments.newComment();
        a3.setRef("A3");

        assertSame(a1, sheetComments.getCTComment("A1"));
        assertSame(a2, sheetComments.getCTComment("A2"));
        assertSame(a3, sheetComments.getCTComment("A3"));
        assertEquals(3, sheetComments.getNumberOfComments());

        assertTrue(sheetComments.removeComment("A1"));
        assertEquals(2, sheetComments.getNumberOfComments());
        assertNull(sheetComments.getCTComment("A1"));
        assertSame(a2, sheetComments.getCTComment("A2"));
        assertSame(a3, sheetComments.getCTComment("A3"));

        assertTrue(sheetComments.removeComment("A2"));
        assertEquals(1, sheetComments.getNumberOfComments());
        assertNull(sheetComments.getCTComment("A1"));
        assertNull(sheetComments.getCTComment("A2"));
        assertSame(a3, sheetComments.getCTComment("A3"));

        assertTrue(sheetComments.removeComment("A3"));
        assertEquals(0, sheetComments.getNumberOfComments());
        assertNull(sheetComments.getCTComment("A1"));
        assertNull(sheetComments.getCTComment("A2"));
        assertNull(sheetComments.getCTComment("A3"));
    }


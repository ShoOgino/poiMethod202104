    @Test
	public void testDetectAsPOIFS() throws IOException {
        Object[][] fileAndMagic = {
                {"SampleSS.xlsx", FileMagic.OOXML},
                {"SampleSS.xls", FileMagic.OLE2},
                {"SampleSS.txt", FileMagic.UNKNOWN}
        };

	    for (Object[] fm : fileAndMagic) {
	        try (InputStream is = FileMagic.prepareToCheckMagic(HSSFTestDataSamples.openSampleFileStream((String)fm[0]))) {
				FileMagic act = FileMagic.valueOf(is);

				assertEquals(act == FileMagic.OOXML, DocumentFactoryHelper.hasOOXMLHeader(is),
					"OOXML files should be detected, others not");

				assertEquals(fm[1], act, "file magic failed for " + fm[0]);
			}
	    }
	}


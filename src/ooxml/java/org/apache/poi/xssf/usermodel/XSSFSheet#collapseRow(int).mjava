    /**
     * @param rowIndex the zero based row index to collapse
     */
    private void collapseRow(int rowIndex) {
    	XSSFRow row = getRow(rowIndex);
    	if (row != null) {
    		int startRow = findStartOfRowOutlineGroup(rowIndex);

    		// Hide all the columns until the end of the group
    		int lastRow = writeHidden(row, startRow, true);
    		if (getRow(lastRow) != null) {
    			getRow(lastRow).getCTRow().setCollapsed(true);
    		} else {
    			XSSFRow newRow = createRow(lastRow);
    			newRow.getCTRow().setCollapsed(true);
    		}
    	}
    }

